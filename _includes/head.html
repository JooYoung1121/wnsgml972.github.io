<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="naver-site-verification" content="a63e100389d113a0ee1c6ac3b07807ca38cadd52"/>

<!-- CSS -->
  <link rel="stylesheet" href="{{ "/css/main.css" | prepend: site.baseurl }}">

<!-- setting index.html -->
  <link rel="canonical" href="{{ page.url | replace:'index.html','' | prepend: site.baseurl | prepend: site.url }}">

<!-- add rss link -->
  <link rel="alternate" type="application/rss+xml" title="{{ site.title }}" href="{{ "/feed.xml" | prepend: site.baseurl | prepend: site.url }}">

<!-- Google font -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Noto Sans">

<!-- font awesome -->
  <link rel="stylesheet" href="/css/font-awesome/css/font-awesome.min.css">

<!-- add korea font -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/jejugothic.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/nanumgothic.css">
  <style>
    .hangle{
      font-family: 'Jeju Gothic', serif;
      font-weight: 500;
      font-size : 15px;
    }
  </style>

<!-- add favicon -->
  <link rel="shortcut icon" href="/favicon.ico">

<!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-113140483-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-113140483-1');
  </script>


<!-- Global script - Google Analytics API -->
<script>
  // Replace with your client ID from the developer console. https://console.developers.google.com/apis/credentials
  var CLIENT_ID = '1085651883761-irvmcin30c2eqfkem2lmbcdij60fe7f0.apps.googleusercontent.com';
  // Replace with your view ID. from https://ga-dev-tools.appspot.com/account-explorer/
  var VIEW_ID = '168704650';
  var DISCOVERY = 'https://analyticsreporting.googleapis.com/$discovery/rest';
  var SCOPES = ['https://www.googleapis.com/auth/analytics.readonly'];

  function authorize(event) {
    // Handles the authorization flow.
    // `immediate` should be false when invoked from the button click.
    var useImmdiate = event ? false : true;
    var authData = {
      client_id: CLIENT_ID,
      scope: SCOPES,
      immediate: useImmdiate
    };
    gapi.auth.authorize(authData, function(response) {
      if (response.error) {
	$(".getViews").text("인증필요");
      }
      else {
	$(".getViews").text("불러오는 중");
        queryReports();
      }
    });
  }

  function queryReports() {
    // Load the API from the client discovery URL.
    gapi.client.load(DISCOVERY
    ).then(function() {
        // Call the Analytics Reporting API V4 batchGet method.
        gapi.client.analyticsreporting.reports.batchGet( {
          "reportRequests":[
          {
            "viewId":VIEW_ID,
            "dateRanges":[
              {
                "startDate":"7daysAgo",
                "endDate":"today"
              }],
            "dimensions": [
              {
                "name": "ga:pagePath"
              }],
            "dimensionFilterClauses": [
              {
                "filters": [
                  {
                    "dimensionName": "ga:pagePath",
                    "not": false,
                    "expressions": [
                      "\\"+location.pathname
                    ],
                    "caseSensitive": false,
                  }
                ]
              }],
            "metrics":[
              {
                "expression":"ga:hits"
              }],
            "orderBys": [
              {
                "fieldName": "ga:hits",
                "sortOrder": "DESCENDING",
              }
            ],
          }]
        } ).then(function(response) {
          var parse = JSON.parse(response.body);
          var views = "지난 1주일간 조회수: "+parse.reports[0].data.totals[0].values[0];
          console.log(views);
	  $(".getViews").text(views);
        })
        .then(null, function(err) {
            // Log any errors.
            console.log(err);
        });
    });
  }
 $(".getViews").click(function(){authorize(event);});
</script>
<script async src="https://apis.google.com/js/client.js"></script>
</head>
